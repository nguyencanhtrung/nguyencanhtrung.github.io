---
layout: distill
title: Using FIFO in Intel platform
description: Working with FIFOs
date: 2022-11-23
tags: intel
categories: intel en

authors:
  - name: Nguyen Canh Trung
    url: "https://bobibo.one"
    affiliations:
      name: bobibo.one

bibliography: 2018-12-22-distill.bib

# Optionally, you can add a table of contents to your post.
# NOTES:
#   - make sure that TOC names match the actual section names
#     for hyperlinks within the post to work correctly.
#   - we may want to automate TOC generation in the future using
#     jekyll-toc plugin (https://github.com/toshimaru/jekyll-toc).
toc:
  - name: 1. Overview
  - name: 2. Instantiate and configure FIFO
    subsections:
      - name: a. FIFO parameter editor
      - name: b. Megafuntions
  - name: 3. Important configurations
  - name: 4. Examples

# Below is an example of injecting additional post-specific styles.
# If you use this post as a template, delete this _styles block.
_styles: >
  .fake-img {
    background: #bbb;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 12px;
  }
  .fake-img p {
    font-family: monospace;
    color: white;
    text-align: left;
    margin: 12px 0;
    text-align: center;
    font-size: 16px;
  }

---

## 1. Overview

There are 3 types of FIFO 

* SCFIFO: single-clock FIFO
* DCFIFO: dual-clock FIFO (supports same port widths for input and output data)
* DCFIFO_MIXED_WIDTHS: dual-clock FIFO (supports different port widths for input and output data)

When comparing with Xilinx,

| Intel | Xilinx |
|:-:    |      :-:|
|SCFIFO | Synchronous FIFO|
|DCFIFO | Asynchronous FIFO|


## 2. Instantiate and configure FIFO

Xilinx has 2 approaches for declaring and configuring FIFO IP core. Intel also provides the same.


### a. Megafuntions

  Instantiate the library:

```bash
LIBRARY altera_mf;
USE altera_mf.altera_mf_components.all;
```

The VHDL component declaration is located in 

```bash
< Intel® Quartus® Prime installation directory>eda/fv_lib/vhdl/megafunctions/altera_mf_components.vhd
```

Here is `dcfifo` declaration

```bash
component dcfifo
  generic (
    add_ram_output_register : string := "OFF";
    add_usedw_msb_bit : string := "OFF";
    clocks_are_synchronized : string := "FALSE";
    delay_rdusedw : integer := 1;
    delay_wrusedw : integer := 1;
    intended_device_family  : string := "unused";
    enable_ecc  : string := "FALSE";
    lpm_numwords  : integer;
    lpm_showahead : string := "OFF";
    lpm_width : integer;
    lpm_widthu  : integer := 1;
    overflow_checking : string := "ON";
    rdsync_delaypipe  : integer := 0;
    read_aclr_synch : string := "OFF";
    underflow_checking  : string := "ON";
    use_eab : string := "ON";
    write_aclr_synch  : string := "OFF";
    wrsync_delaypipe  : integer := 0;
    lpm_hint  : string := "UNUSED";
    lpm_type  : string := "dcfifo"
  );
  port(
    aclr  : in std_logic := '0';
    data  : in std_logic_vector(lpm_width-1 downto 0) := (others => '0');
    eccstatus : out std_logic_vector(2-1 downto 0);
    q : out std_logic_vector(lpm_width-1 downto 0);
    rdclk : in std_logic := '0';
    rdempty : out std_logic;
    rdfull  : out std_logic;
    rdreq : in std_logic := '0';
    rdusedw : out std_logic_vector(lpm_widthu-1 downto 0);
    wrclk : in std_logic := '0';
    wrempty : out std_logic;
    wrfull  : out std_logic;
    wrreq : in std_logic := '0';
    wrusedw : out std_logic_vector(lpm_widthu-1 downto 0)
  );
end component;
```

Note: if using Stratix 10, `use_eab = ON` is a must.

Looking at signals description <strong>[here](https://www.intel.com/content/www/us/en/docs/programmable/683522/18-0/fifo-signals.html)</strong> and parameters description <strong>[here](https://www.intel.com/content/www/us/en/docs/programmable/683522/18-0/fifo-parameter-settings.html)</strong>

### b. FIFO parameter editor

Openning IP Catalog,

`Basic Functions > On Chip memory > FIFO intel` 

There, you can configure your FIFOs. Then, generating IP > Open the HDL file to copy the top module as the component in your design.

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/01.blogs/221123_fifo_intel/1.png" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

### c. What are differences?

| Megafunctions     | IP Catalog    |
| :-                | :-            |
| Users must specify timing constraints by themselve. To constraint megafunction FIFO is shown [here](https://community.intel.com/t5/FPGA-Wiki/DCFIFO-Timing-Constraints/ta-p/735793) and [here](https://www.intel.com/content/www/us/en/docs/programmable/683082/22-3/dual-clock-fifo-timing-constraints.html) | Timing constraints is automatically generated by the tool. If you are not sure how to constraint the design, this way is recommended. |



## 3. Important configurations

### Clear

### Normal vs Show-Ahead mode


## 4. Example design

http://blogs.plymouth.ac.uk/embedded-systems/fpga-and-vhdl/testing-understanding-the-scfifo-megafunction/

## References

* [1] https://www.intel.com/content/www/us/en/docs/programmable/683522/18-0/vhdl-library-use-declaration.html
* [2] https://www.intel.com/content/www/us/en/docs/programmable/683522/18-0/vhdl-component-declaration.html